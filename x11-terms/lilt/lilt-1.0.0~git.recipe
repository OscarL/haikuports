SUMMARY="The Lil Terminal"
DESCRIPTION="The Lilt terminal emulator - a simple and portable terminal emulator for Linux, macOS,
and other Unix-like systems"
HOMEPAGE="https://github.com/MurphyMc/lilt/"
COPYRIGHT="2019 Murphy McCauley"
LICENSE="
	MIT
	BSD (3-clause)
	"
REVISION="1"
srcGitRev="6b91c90e521315e427c243cfb689138c3cd7c376"
SOURCE_URI="https://github.com/MurphyMc/lilt/archive/$srcGitRev.tar.gz"
CHECKSUM_SHA256="47befef722b135d2ec4dff2d4abad5786c923e0ec03aeccd894bb782bffa20d5"
SOURCE_DIR="lilt-$srcGitRev"
srcGitRev2="08ed9968ab114057e8eefd922058810f451b8cdd"
SOURCE_URI_2="https://github.com/MurphyMc/libtmt/archive/$srcGitRev2.tar.gz"
CHECKSUM_SHA256_2="18685884cdc9bc742a502bbb84b7441b47ec6c5e5e118515848b2600fe001e21"
SOURCE_DIR_2="libtmt-$srcGitRev2"

ADDITIONAL_FILES="lilt.rdef.in"

ARCHITECTURES="all !x86_gcc2"
SECONDARY_ARCHITECTURES="x86"

PROVIDES="
	lilt$secondaryArchSuffix = $portVersion
	app:LilT = $portVersion
	cmd:lilt = $portVersion
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libSDL_1.2$secondaryArchSuffix
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libSDL_1.2$secondaryArchSuffix
	"

BUILD_PREREQUIRES="
	cmd:cmake
	cmd:g++$secondaryArchSuffix
	cmd:make
	"

BUILD()
{
	mkdir -p $sourceDir/libtmt
	cp -f $sourceDir2/* $sourceDir/libtmt

	cmake . -DCMAKE_BUILD_TYPE=Release
	cmake --build .
}

INSTALL()
{
	mkdir -p $binDir $appsDir
	mv lilt $appsDir/Lilt
	ln -s $appsDir/Lilt $prefix/bin/lilt

	_portVersion=${portVersion%%~git}
	local APP_SIGNATURE="application/x-vnd.MurphyMC-lilt"
	local MAJOR="`echo "$_portVersion" | cut -d. -f1`"
	local MIDDLE="`echo "$_portVersion" | cut -d. -f2`"
	local MINOR="`echo "$_portVersion" | cut -d. -f3`"
	local LONG_INFO="$SUMMARY"
	sed \
		-e "s|@APP_SIGNATURE@|$APP_SIGNATURE|" \
		-e "s|@MAJOR@|$MAJOR|" \
		-e "s|@MIDDLE@|$MIDDLE|" \
		-e "s|@MINOR@|$MINOR|" \
		-e "s|@LONG_INFO@|$LONG_INFO|" \
		$portDir/additional-files/lilt.rdef.in > lilt.rdef

	addResourcesToBinaries lilt.rdef $appsDir/Lilt
	addAppDeskbarSymlink $appsDir/Lilt
}
