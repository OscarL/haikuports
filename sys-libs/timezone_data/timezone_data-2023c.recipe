SUMMARY="Timezone data and utilities"
DESCRIPTION="The Time Zone Database (often called tz or zoneinfo) contains \
code and data that represent the history of local time for many \
representative locations around the globe. It is updated periodically to \
reflect changes made by political bodies to time zone boundaries, \
UTC offsets, and daylight-saving rules. Its management procedure is \
documented in BCP 175: Procedures for Maintaining the Time Zone Database."
HOMEPAGE="https://www.iana.org/time-zones"
COPYRIGHT="2020-2022 Arthur David Olson"
LICENSE="
	Public Domain
	BSD (3-clause)
	"
REVISION="2"
SOURCE_URI="https://data.iana.org/time-zones/releases/tzdb-$portVersion.tar.lz"
CHECKSUM_SHA256="08fd090f1a16d522ae4e9247445056f4155002239e5be760b31ba0376d2e632c"
SOURCE_DIR="tzdb-$portVersion"
PATCHES="timezone_data-$portVersion.patchset"

ARCHITECTURES="all !x86_gcc2"
SECONDARY_ARCHITECTURES="x86"

commandSuffix=$secondaryArchSuffix
commandBinDir=$binDir
if [ "$targetArchitecture" = x86_gcc2 ]; then
	commandSuffix=
	commandBinDir=$prefix/bin
fi

PROVIDES="
	timezone_data$secondaryArchSuffix = $portVersion
	cmd:tzselect
	cmd:zdump$commandSuffix
	cmd:zic$commandSuffix
	devel:libtz$secondaryArchSuffix
	"
REQUIRES="
	haiku$secondaryArchSuffix
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	"
BUILD_PREREQUIRES="
	cmd:awk
	cmd:gcc$secondaryArchSuffix
	cmd:ld$secondaryArchSuffix
	cmd:make
	"

BUILD()
{
	make \
		USRDIR=$prefix \
		USRSHAREDIR=${dataDir:1} \
		ZICDIR=$binDir \
		MANDIR=$manDir
}

INSTALL()
{
	mkdir -p $dataDir/zoneinfo $dataDir/zoneinfo-leaps
	make \
		USRDIR=$prefix \
		USRSHAREDIR=${dataDir:1} \
		ZICDIR=$commandBinDir \
		MANDIR=$manDir \
		LIBDIR=$libDir \
		install

	prepareInstalledDevelLibs libtz
}
